<!doctype html>
<html>
<head>
  <title>Playground - Ping</title>
</head>
<body>

<h1 id="client-id"></h1>

<p id="result"></p>

<script src="/auto-peer.min.js"></script>
<script>
  var result = new Array(5);
  var pingSent;
  var autoPeer = new AutoPeer();

  autoPeer.on('autoPeer:connected', function (clientId) {
    document.getElementById('client-id').innerHTML = clientId;
  });

  autoPeer.on('ping', function (message, data) {
    autoPeer.sendTo(data.source, 'pong');
  });

  autoPeer.on('pong', function (message, data) {
    var pongReceived = new Date();
    result.push(data.source + ': ' + (pongReceived - pingSent) + ' ms');
    result.shift();
    document.getElementById('result').innerHTML = result.join('<br/>');
  });

  setInterval(function () {
    pingSent = new Date();
    autoPeer.send('ping');
  }, 1000);

</script>


</body>
</html>
